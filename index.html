<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  </head>
  <body>
    <iframe 
      src="https://forms.office.com/Pages/ResponsePage.aspx?id=vRxhusw1LUG1L0yyGYtmRS1wLbgaPDRBv4L-zj1ZHNVUOElXRVhSNjBKRFI1NUhNNTdXV1M1STdOMS4u" 
      width="200" 
      height="200" 
      allowtransparency="true" 
      frameborder="0" 
      sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts">
    </iframe>

    <script type="module">
      import kaboom from "https://unpkg.com/kaboom/dist/kaboom.mjs";

      // Kaboom config
      kaboom({
        global: true,
        fullscreen: true,
        scale: 2.5,
        debug: true,
        background: [51, 151, 255],
      });

      //KOULUTUS ALA LINKIT
      //https://www.keuda.fi/ala/humanistiset-taidealat/
      //https://www.keuda.fi/ala/kauppa-hallinto-oikeustieteet/
      //https://www.keuda.fi/ala/luonnontieteet/
      //https://www.keuda.fi/ala/maa-ja-metsatalousala-myos-puutarha-ala/
      //https://www.keuda.fi/ala/palvelualat/
      //https://www.keuda.fi/ala/tekniikan-alat/
      //https://www.keuda.fi/ala/terveys-hyvinvointialat/
      //https://www.keuda.fi/ala/tietojenkasittely-tietoliikenne-ict/

      let playerMoveSpeed = 150;
      let playerJumpForce = 250;
      let playerPoints = 0;

      let scopeA = 0; // Humanistiset ja taidealat
      let scopeB = 0; // Kauppa, hallinto ja oikeustieteet
      let scopeC = 0; // Luonnontieteet
      let scopeD = 0; // Maa- ja metsätalous
      let scopeE = 0; // Palvelualat
      let scopeF = 0; // Tekniikan alat
      let scopeG = 0; // Terveys ja hyvinvointialat
      let scopeH = 0; // Tietojenkäsittely ja tietoliikenne

      // Load graphics
      loadSprite("logo", "Kuvat/keuda_logo.png");
      loadSprite("bg", "Kuvat/tausta.png");
      loadSprite("bg2", "Kuvat/tausta_shade.png");
      loadSprite("ground", "Kuvat/tausta_alareuna.png");
      loadSprite("mario", "Kuvat/hahmo.png");
      loadSprite("suprise", "Kuvat/block_tyhja_kysymys.png");
      loadSprite("spider", "Kuvat/örkki.png");
      loadSprite("block", "Kuvat/block.png");
      loadSprite("tunnel", "Kuvat/ampari.png");
      loadSprite("arrow", "Kuvat/nuoli.png");
      loadSprite("reminder", "Kuvat/teksti_nuoli.png");
      loadSprite("flagfinish", "Kuvat/maali_tausta_levelille.png");
      loadSprite("start", "Kuvat/start.png");
      loadSprite('empty', 'Kuvat/block_vastaus.png');
      loadSprite('end', 'Kuvat/maali_tausta.png');
      loadSprite('endback', 'Kuvat/maali_tausta_ala.png');
      loadSprite('endbox', 'Kuvat/loppu_solu.png');
      loadSprite('ala1', 'Kuvat/ala1.png');
      loadSprite('ala2', 'Kuvat/ala2.png');
      loadSprite('ala3', 'Kuvat/ala3.png');
      loadSprite('ala4', 'Kuvat/ala4.png');
      loadSprite('ala5', 'Kuvat/ala5.png');
      loadSprite('ala6', 'Kuvat/ala6.png');
      loadSprite('ala7', 'Kuvat/ala7.png');
      loadSprite('ala8', 'Kuvat/ala8.png');

      loadSprite("k1", "Kuvat/kysymykset/k_1.png");
      loadSprite("k2", "Kuvat/kysymykset/k_2.png");
      loadSprite("k3", "Kuvat/kysymykset/k_3.png");

      loadSprite("k4", "Kuvat/kysymykset/k_4.png");
      loadSprite("k5", "Kuvat/kysymykset/k_5.png");
      loadSprite("k6", "Kuvat/kysymykset/k_6.png");

      loadSprite("k7", "Kuvat/kysymykset/k_7.png");
      loadSprite("k8", "Kuvat/kysymykset/k_8.png");


      loadSprite("k1a", "Kuvat/kysymykset/k_1_a.png");
      loadSprite("k1b", "Kuvat/kysymykset/k_1_b.png");
      loadSprite("k1c", "Kuvat/kysymykset/k_1_c.png");
      loadSprite("k2a", "Kuvat/kysymykset/k_2_a.png");
      loadSprite("k2b", "Kuvat/kysymykset/k_2_b.png");
      loadSprite("k2c", "Kuvat/kysymykset/k_2_c.png");
      loadSprite("k3a", "Kuvat/kysymykset/k_3_a.png");
      loadSprite("k3b", "Kuvat/kysymykset/k_3_b.png");
      loadSprite("k4a", "Kuvat/kysymykset/k_4_a.png");
      loadSprite("k4b", "Kuvat/kysymykset/k_4_b.png");
      loadSprite("k4c", "Kuvat/kysymykset/k_4_c.png");
      loadSprite("k5a", "Kuvat/kysymykset/k_5_a.png");
      loadSprite("k5b", "Kuvat/kysymykset/k_5_b.png");
      loadSprite("k5c", "Kuvat/kysymykset/k_5_c.png");
      loadSprite("k6a", "Kuvat/kysymykset/k_6_a.png");
      loadSprite("k6b", "Kuvat/kysymykset/k_6_b.png");
      loadSprite("k6c", "Kuvat/kysymykset/k_6_c.png");
      loadSprite("k7a", "Kuvat/kysymykset/k_7_a.png");
      loadSprite("k7b", "Kuvat/kysymykset/k_7_b.png");
      loadSprite("k8a", "Kuvat/kysymykset/k_8_a.png");
      loadSprite("k8b", "Kuvat/kysymykset/k_8_b.png");
      loadSprite("k8c", "Kuvat/kysymykset/k_8_c.png");

      // Load sounds
      loadSound("block", "./audio/block.wav");
      loadSound("hit", "./audio/hit.wav");
      loadSound("hyppy", "./audio/jump.mp3");

      // Load levels
      let levels = [
        [
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£      (           £",
          "£                  £",
          "£                  £",
          "£                  £",
          "====================",
        ],
        [
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                         `                         £",
          "£                                                   £",
          "£             /           D  E  F     ¤       -     £",
          "£                         M  N  O                   £",
          "£             A  B  C                 G     I     ^ £",
          "£             J  K  L                 P     Q       £",
          "£                        =========                + £",
          "£                       ===========                 £",
          "=====================================================",
        ],
        [
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£           /                  `                   ¤                    £",
          "£                                                                  -    £",
          "£           A   B   C          D    E    F         G   H   I          ^ £",
          "£                                                                       £",
          "£                        £                                            + £",
          "£                        £                     #                        £",
          "=========================================================================",
        ],
        [
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£            /                 `                                        £",
          "£                                                                       £",
          "£            A     B           D  E  F                             -    £",
          "£                                                                     ^ £",
          "£                        £                                            + £",
          "£                        £                                  #           £",
          "=========================================================================",
        ],
        [
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
          "                                           ",
        ],
      ];

      scene("firstLevel", () => {
        debug.log("Aloitus ");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(50, 240),
          body(),
          area(),
          scale(0.7),
        ]);

        add([
          sprite("bg2", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        addLevel(levels[0], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],
          "(": () => [sprite("start"), area(), scale(0.5), "Start"],
        });

        player.onCollide("Start", (Start) => {
          go("secondLevel");
        });

        gravity(660);

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.2,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("secondLevel", () => {
        debug.log("TASO 1");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 360),
          body(),
          area(),
          scale(0.7),
        ]);

        add([
          sprite("bg2", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        addLevel(levels[1], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.5), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          A: () => [sprite("suprise"), solid(), area(), scale(0.4), "A"],
          B: () => [sprite("suprise"), solid(), area(), scale(0.4), "B"],
          C: () => [sprite("suprise"), solid(), area(), scale(0.4), "C"],
          D: () => [sprite("suprise"), solid(), area(), scale(0.4), "D"],
          E: () => [sprite("suprise"), solid(), area(), scale(0.4), "E"],
          F: () => [sprite("suprise"), solid(), area(), scale(0.4), "F"],
          G: () => [sprite("suprise"), solid(), area(), scale(0.4), "G"],
          I: () => [sprite("suprise"), solid(), area(), scale(0.4), "I"],
          "-": () => [sprite("reminder"), area(), scale(0.25), "Reminder"],

          "/": () => [sprite("k1"), area(), scale(0.2), "K1"],
          "`": () => [sprite("k2"), area(), scale(0.2), "K2"],
          "¤": () => [sprite("k3"), area(), scale(0.2), "K3"],
          J: () => [sprite("k1a"), pos(0, 1), area(), scale(0.12), "K1A"],
          K: () => [sprite("k1b"), pos(0, 1), area(), scale(0.12), "K1B"],
          L: () => [sprite("k1c"), pos(-10, 1), area(), scale(0.12), "K1C"],
          M: () => [sprite("k2a"), pos(-5, 1), area(), scale(0.12), "K2A"],
          N: () => [sprite("k2b"), pos(-5, 1), area(), scale(0.12), "K2B"],
          O: () => [sprite("k2c"), pos(0, 1), area(), scale(0.12), "K2C"],
          P: () => [sprite("k3a"), pos(-10, 1), area(), scale(0.12), "K3A"],
          Q: () => [sprite("k3b"), pos(-20, 1), area(), scale(0.12), "K3B"],
          R: () => [sprite(""), pos(0, 1), area(), scale(0.12), "K1A"],
        });
        //kysymys 1
        player.onCollide("A", (A) => {
          let x = A.pos.x;
          let y = A.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeD++;
          scopeE++;
        });

        player.onCollide("B", (B) => {
          let x = B.pos.x;
          let y = B.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeB++;
          scopeE++;
          scopeH++;
        });

        player.onCollide("C", (C) => {
          let x = C.pos.x;
          let y = C.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeF++;
          scopeG++;
        });

        //kysymys 2
        player.onCollide("D", (D) => {
          let x = D.pos.x;
          let y = D.pos.y;
          destroyAll("D");
          destroyAll("E");
          destroyAll("F");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeB++;
          scopeF++;
          scopeH++;
        });

        player.onCollide("E", (E) => {
          let x = E.pos.x;
          let y = E.pos.y;
          destroyAll("D");
          destroyAll("E");
          destroyAll("F");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeE++;
          scopeG++;
        });

        player.onCollide("F", (F) => {
          let x = F.pos.x;
          let y = F.pos.y;
          destroyAll("D");
          destroyAll("E");
          destroyAll("F");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeD++;
        });

        //kysymys 3
        player.onCollide("G", (G) => {
          let x = G.pos.x;
          let y = G.pos.y;
          destroyAll("G");
          destroyAll("I");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeE++;
          scopeF++;
          scopeG++;
        });

        player.onCollide("I", (I) => {
          let x = I.pos.x;
          let y = I.pos.y;
          destroyAll("G");
          destroyAll("I");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeB++;
          scopeD++;
          scopeH++;
        });

        player.onCollide("Tunnel", (Tunnel) => {
          go("thirdLevel");
        });

        gravity(660);

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.2,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("thirdLevel", () => {
        debug.log("TASO 2");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        add([
          sprite("bg2", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 250),
          body(),
          area(),
          scale(0.7),
        ]);

        gravity(660);

        addLevel(levels[2], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), "Block"],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), "Wall"],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          A: () => [sprite("suprise"), solid(), area(), scale(0.4), "A"],
          B: () => [sprite("suprise"), solid(), area(), scale(0.4), "B"],
          C: () => [sprite("suprise"), solid(), area(), scale(0.4), "C"],
          D: () => [sprite("suprise"), solid(), area(), scale(0.4), "D"],
          E: () => [sprite("suprise"), solid(), area(), scale(0.4), "E"],
          F: () => [sprite("suprise"), solid(), area(), scale(0.4), "F"],
          G: () => [sprite("suprise"), solid(), area(), scale(0.4), "G"],
          H: () => [sprite("suprise"), solid(), area(), scale(0.4), "H"],
          I: () => [sprite("suprise"), solid(), area(), scale(0.4), "I"],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],

          "/": () => [sprite("k4"), area(), scale(0.2), "K4"],
          "`": () => [sprite("k5"), area(), scale(0.15), "K5"],
          "¤": () => [sprite("k6"), area(), scale(0.2), "K6"],
        });

        add([text("TASO 2"), pos(125, 275), scale(0.2)]);

        add([text("Teen taidetta"), pos(223, 286), scale(0.1)]);
        add([text("Rakentelen ja\n nikkaroin"), pos(300, 286), scale(0.1)]);
        add([text("Viihdyn luonnossa"), pos(380, 286), scale(0.1)]);

        player.onCollide("A", (A) => {
          let x = A.pos.x;
          let y = A.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeA++;
        });
        player.onCollide("B", (B) => {
          let x = B.pos.x;
          let y = B.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeF++;
        });
        player.onCollide("C", (C) => {
          let x = C.pos.x;
          let y = C.pos.y;
          destroyAll("A");
          destroyAll("B");
          destroyAll("C");
          add([pos(x, y), sprite("empty"), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeD++;
        });

        add([text("Autan ja \npalvelen muita"), pos(600, 286), scale(0.1)]);
        add([
          text("Suunnittelua ja \njarjestelmallisyytta"),
          pos(690, 286),
          scale(0.1),
        ]);
        add([
          text("Luovuutta ja \nkasilla tekemista"),
          pos(800, 286),
          scale(0.1),
        ]);

        player.onCollide("D", (D) => {
          let x = D.pos.x;
          let y = D.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeE++;
          scopeG++;
        })
        player.onCollide('E', (E) => {
          let x = E.pos.x;
          let y = E.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeB++;
          scopeD++;
          scopeF++;
          scopeH++;
        })
        player.onCollide('F', (F) => {
          let x = F.pos.x;
          let y = F.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeC++;
        })

        // 3
        add([text('Tietokoneella naputtaen'), pos(1005, 286), scale(0.1)]);
        add([text('Jakoavaimella muttereita vaannellen'), pos(1089, 286), scale(0.1)]);
        add([text('Puhumalla'), pos(1170, 286), scale(0.1)]);

        player.onCollide('G', (G) => {
          let x = G.pos.x;
          let y = G.pos.y;
          destroyAll('G')
          destroyAll('H')
          destroyAll('I')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeB++;
          scopeH++;
        })
        player.onCollide('H', (H) => {
          let x = H.pos.x;
          let y = H.pos.y;
          destroyAll('G')
          destroyAll('H')
          destroyAll('I')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeD++;
          scopeF++;
        })
        player.onCollide('I', (I) => {
          let x = I.pos.x;
          let y = I.pos.y;
          destroyAll('G')
          destroyAll('H')
          destroyAll('I')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeE++;
          scopeG++;
        })

        player.onCollide("Tunnel", (Tunnel) => {
          go("fourthLevel");
        });

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.2,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("fourthLevel", () => {
        debug.log("TASO 3");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 160),
          body(),
          area(),
          scale(0.7),
        ]);

        add([
          sprite("bg2", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        gravity(660);

        addLevel(levels[3], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "*": () => [sprite("arrow"), solid(), area(), scale(0.5), "Death"],
          A: () => [sprite("suprise"), solid(), area(), scale(0.4), "A"],
          B: () => [sprite("suprise"), solid(), area(), scale(0.4), "B"],
          C: () => [sprite("suprise"), solid(), area(), scale(0.4), "C"],
          D: () => [sprite("suprise"), solid(), area(), scale(0.4), "D"],
          E: () => [sprite("suprise"), solid(), area(), scale(0.4), "E"],
          F: () => [sprite("suprise"), solid(), area(), scale(0.4), "F"],
          G: () => [sprite("suprise"), solid(), area(), scale(0.4), "G"],
          H: () => [sprite("suprise"), solid(), area(), scale(0.4), "H"],
          I: () => [sprite("suprise"), solid(), area(), scale(0.4), "I"],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],
          "!": () => [
            sprite("flagfinish"),
            solid(),
            area(),
            scale(0.5),
            "flagfinish",
          ],

          "/": () => [sprite("k7"), area(), scale(0.2), "K7"],
          "`": () => [sprite("k8"), area(), scale(0.2), "K8"],
        });

        add([text("TASO 3"), pos(125, 280), scale(0.2)]);

        // 1
        add([text("Aikataulua \nnoudattaen?"), pos(245, 286), scale(0.1)]);
        add([
          text("Joustavasti, \ntilanteen mukaan?"),
          pos(350, 286),
          scale(0.1),
        ]);

        player.onCollide("A", (A) => {
          let x = A.pos.x;
          let y = A.pos.y;
          destroyAll('A')
          destroyAll('B')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeB++;
          scopeD++;
          scopeE++;
          scopeF++;
        })

        player.onCollide("B", (B) => {
          let x = B.pos.x;
          let y = B.pos.y;
          destroyAll('A')
          destroyAll('B')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeC++;
          scopeG++;
          scopeH++;
        })

        /// 2

        add([text("Kylla"), pos(610, 286), scale(0.1)]);
        add([text("Vahan"), pos(675, 286), scale(0.1)]);
        add([text("En"), pos(740, 286), scale(0.1)]);

        player.onCollide("D", (D) => {
          let x = D.pos.x;
          let y = D.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeA++;
          scopeB++;
          scopeH++;
        })

        player.onCollide("E", (E) => {
          let x = E.pos.x;
          let y = E.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeF++;
          scopeG++;
        })

        player.onCollide("F", (F) => {
          let x = F.pos.x;
          let y = F.pos.y;
          destroyAll('D')
          destroyAll('E')
          destroyAll('F')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
          scopeC++;
          scopeD++;
          scopeE++;
        })

        player.onCollide("Tunnel", (Tunnel) => {
          go("fifthlevel");
        });

        player.onCollide("Death", (Death) => {
          shake(50);
          go("fourthLevel");
        });

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.2,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      // EndScreen
      scene("fifthlevel", () => {
        debug.log("End Screen");

        $('iframe').css('display', 'flex')

        // $('.embed-view-content').text('Anna palautetta')

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("bg2", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        addLevel(levels[3], {
          width: 20,
          height: 20,
        });

        let endback = add([
          sprite("endback"),
          pos(width() / 2, 190),
          origin("center"),
          scale(0.1216),
          fixed(),
        ]);

        let end = add([
          sprite("end"),
          pos(width() / 2, 65),
          origin("center"),
          scale(0.109),
          fixed(),
        ]);
        
        let endbox = add([
          sprite("endbox"),
          pos(width() / 2, 260),
          origin("center"),
          scale(0.1172),
          fixed()
        ]);

        //teksti kenttä ensimmäistä laatikkoa varten--------------------------------------
        add([
          text('1:'),
          pos(width() / 2 - 200, height() / 2 - 35),
          scale(0.5),
        ])

        //teksti kenttä toista laatikkoa varten-------------------------------------------
        add([
          text('2:'),
          pos(width() / 2 - 200, height() / 2 + 50),
          scale(0.5),
        ])

        //teksti kenttä kolmatta laatikkoa varten-----------------------------------------
        add([
          text('3:'),
          pos(width() / 2 - 200, height() / 2 + 135),
          scale(0.5),
        ])

        add([
          text('Kiitos pelaamisesta'),
          pos(width() / 2 - 123, height() / 2 - 90),
          scale(0.3),
        ]);

        add([
          text('Sinulle sopivia aloja voisivat olla:'),
          pos(width() / 2 - 115, height() /2 - 60),
          scale(0.15),
        ])

        const ensimmainen = Math.max(scopeA, scopeB, scopeC, scopeD, scopeE, scopeF, scopeG, scopeH);
        if(ensimmainen == scopeA)
        {
          scopeA = 0;
          add([sprite("ala1"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeB)
        {
          scopeB = 0;
          add([sprite("ala2"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeC)
        {
          scopeC = 0;
          add([sprite("ala3"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);         
        } else if(ensimmainen == scopeD)
        {
          scopeD = 0;
          add([sprite("ala4"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeE)
        {
          scopeE = 0;
          add([sprite("ala5"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeF)
        {
          scopeF = 0;
          add([sprite("ala6"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeG)
        {
          scopeG = 0;
          add([sprite("ala7"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        } else if(ensimmainen == scopeH)
        {
          scopeH = 0;
          add([sprite("ala8"), pos(width() / 2 - 115, height() /2 - 10), scale(0.3)]);
        }

        const toinen = Math.max(scopeA, scopeB, scopeC, scopeD, scopeE, scopeF, scopeG, scopeH);
        if(toinen == scopeA)
        {
          scopeA = 0;
          add([sprite("ala1"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeB)
        {
          scopeB = 0;
          add([sprite("ala2"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeC)
        {
          scopeC = 0;   
          add([sprite("ala3"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);       
        } else if(toinen == scopeD)
        {
          scopeD = 0;
          add([sprite("ala4"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeE)
        {
          scopeE = 0;
          add([sprite("ala5"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeF)
        {
          scopeF = 0;
          add([sprite("ala6"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeG)
        {
          scopeG = 0;
          add([sprite("ala7"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        } else if(toinen == scopeH)
        {
          scopeH = 0;
          add([sprite("ala8"), pos(width() / 2 - 115, height() /2 - -10), scale(0.3)]);
        }

        const kolmas = Math.max(scopeA, scopeB, scopeC, scopeD, scopeE, scopeF, scopeG, scopeH);
        if(kolmas == scopeA)
        {
          scopeA = 0;
          add([sprite("ala1"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeB)
        {
          scopeB = 0;
          add([sprite("ala2"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeC)
        {
          scopeC = 0;
          add([sprite("ala3"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);         
        } else if(kolmas == scopeD)
        {
          scopeD = 0;
          add([sprite("ala4"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeE)
        {
          scopeE = 0;
          add([sprite("ala5"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeF)
        {
          scopeF = 0;
          add([sprite("ala6"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeG)
        {
          scopeG = 0;
          add([sprite("ala7"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        } else if(kolmas == scopeH)
        {
          scopeH = 0;
          add([sprite("ala8"), pos(width() / 2 - 115, height() /2 - -30), scale(0.3)]);  
        }
      });

      onLoad(() => {
        go("firstLevel");
      });
    </script>
  </body>
</html>
