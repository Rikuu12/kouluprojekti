<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      body {
        background-color: black;
        overflow: hidden;
      }
    </style>
    <script type="module">
      import kaboom from 'https://unpkg.com/kaboom/dist/kaboom.mjs';

      kaboom({
        global: true,
        fullscreen: true,
        scale: 2.5,
        debug: true,
        background: [51, 151, 255],
      });

      let playerMoveSpeed = 150;
      let playerJumpForce = 350;
      let playerPoints = 0;

      let scopeA = 0;
      let scopeB = 0;
      let scopeC = 0;
      let scopeD = 0;
      let scopeE = 0;
      let scopeF = 0;
      let scopeG = 0;
      let scopeH = 0;

      loadSprite('logo', 'Kuvat/keuda_logo.png');
      loadSprite('bg', 'Kuvat/tausta.png');
      loadSprite('ground', 'Kuvat/tausta_alareuna.png');
      loadSprite('mario', 'Kuvat/hahmo.png');
      loadSprite('mariojumpoff', 'Kuvat/hahmo_aloitus_tippuminen.png');
      loadSprite('suprise', 'Kuvat/block_kysymys.png');
      loadSprite('spider', 'Kuvat/örkki.png');
      loadSprite('block', 'Kuvat/block.png');
      loadSprite('tunnel', 'Kuvat/ampari.png');
      loadSprite('arrow', 'Kuvat/nuoli.png');
      loadSprite('reminder', 'Kuvat/teksti_nuoli.png');
      loadSprite('empty', 'Kuvat/block_tyhjä.png');

      let levels = [
        [
          '£                                                   £',
          '£                                                   £',
          '£                                                   £',
          '£     %   %   %                   ¤   ¤   ¤         £',
          '£                                                   £',
          '£                                                   £',
          '£                                                   £',
          '£     =========                   =========         £',
          '£                                                   £',
          '£                                                   £',
          '£                                                   £',
          '£                ==        ===                    ^ £',
          '£                                                 + £',
          '£              #                   #                £',
          '=====================================================',
        ],
        [
        '£                                                                       £',
          '£                                                                       £',
          '£                                                                       £',
          '£                                           ¤   ¤   ¤                   £',
          '£                                                                       £',
          '£                                                                       £',
          '£                                                                       £',
          '£                                       ===============                 £',
          '£                                                                       £',
          '£                   %   %   %                                           £',
          '£    =====                        ==                         ===        £',
          '£                                                                     ^ £',
          '£                                                                     + £',
          '£  #                                 =                       #          £',
          '=========================================================================',
        ],
        [
          '£                                 =====         #                       £',
          '£                    ==      ==            ======                       £',
          '£                                                    ===========        £',
          '£                                                                       £',
          '£                                                                       £',
          '£                ==      ==                                             £',
          '£                                                           ==        ^ £',
          '£                                                                     + £',
          '£                #                                          #           £',
          '=========================================================================',
        ],
      ];

      // LEVEL: 1
      scene('firstLevel', () => {
        debug.log('LEVEL 1');

        add([sprite('bg', { width: width(), height: height() }), pos(0, 0), fixed()]);
        add([sprite('ground', { width: screen.width, height: screen.height }), pos(0, 250), fixed()]);
        // add([sprite('logo', { width: 150, height: 50 }), pos(0, 580), fixed()]);

        let player = add([sprite('mario'), solid(), pos(140, 200), body(), area(), scale(0.7)]);

        addLevel(levels[0], {
          width: 20,
          height: 20,
          '=': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '£': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '+': () => [sprite('tunnel'), solid(), area(), scale(0.5), 'Tunnel'],
          '^': () => [sprite('arrow'), scale(0.4), 'Arrow'],
          '#': () => [sprite('spider'), solid(), area(), scale(1), 'Spider'],
          '%': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus1'],
          '-': () => [sprite('reminder'), area(), scale(0.2), 'Reminder'],
          '¤': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus2'],
        });

        // Ykkös kysymys
        add([
          text('Kysymys 1'),
          pos(170, 10),
          scale(0.20),
        ])

        // Ykkös vastaus vaihtoehdot
        add([
          text('Vastaus 1'),
          pos(105, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 2'),
          pos(185, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 3'),
          pos(265, 40),
          scale(0.14),
        ])
        // Ykkös kysymys vastaus
        player.onCollide('Vastaus1', (v1) => {
          let x = v1.pos.x;
          let y = v1.pos.y;
          destroyAll('Vastaus1')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
        })

        // Kakkos kysymys 
        add([
          text('Kysymys 2'),
          pos(730, 10),
          scale(0.20),
        ])

        // Kakkos vastaus vaihtoehdot
        add([
          text('Vastaus 1'),
          pos(662, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 2'),
          pos(742, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 3'),
          pos(822, 40),
          scale(0.14),
        ])

        // Kakkos kysymys vastaus
        player.onCollide('Vastaus2', (v2) => {
          let x = v2.pos.x;
          let y = v2.pos.y;
          destroyAll('Vastaus2')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
        })

        player.onCollide('Tunnel', (Tunnel) => {
          go('secondLevel');
        });

        gravity(660);

        onUpdate('Spider', (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide('Spider', (Spider) => {
          shake(10);
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown('left', () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown('right', () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress('space', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });

        onKeyPress('up', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      // LEVEL: 2
      scene('secondLevel', () => {
        debug.log('LEVEL 2');

        add([sprite('bg', { width: width(), height: height() }), pos(0, 0), fixed()]);
        add([sprite('ground', { width: screen.width, height: screen.height }), pos(0, 250), fixed()]);

        // add([sprite('logo', { width: 150, height: 50 }), pos(0, 580), fixed()]);
        let player = add([sprite('mario'), solid(), pos(140, 250), body(), area(), scale(0.7)]);

        // let player = add([sprite('mariojumpoff'), solid(), pos(140, 160), body(), area(), scale(0.8)]);

        gravity(660);

        addLevel(levels[1], {
          width: 20,
          height: 20,
          '=': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '£': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '+': () => [sprite('tunnel'), solid(), area(), scale(0.5), 'Tunnel'],
          '^': () => [sprite('arrow'), scale(0.4), 'Arrow'],
          '#': () => [sprite('spider'), solid(), area(), scale(1), 'Spider'],
          '%': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus3'],
          '-': () => [sprite('reminder'), area(), scale(0.2), 'Reminder'],
          '¤': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus4'],
        });

        // Kolmas kysymys
        add([
          text('Kysymys 3'),
          pos(450, 128),
          scale(0.20),
        ])

        // Kolmannen vastaus vaihtoehdot
        add([
          text('Vastaus 1'),
          pos(383, 158),
          scale(0.14),
        ])

        add([
          text('Vastaus 2'),
          pos(463, 158),
          scale(0.14),
        ])

        add([
          text('Vastaus 3'),
          pos(543, 158),
          scale(0.14),
        ])
        // Kolmannen kysymys vastaus
        player.onCollide('Vastaus3', (v3) => {
          let x = v3.pos.x;
          let y = v3.pos.y;
          destroyAll('Vastaus3')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
        })

        // Neljäs kysymys 
        add([
          text('Kysymys 4'),
          pos(932, 10),
          scale(0.20),
        ])

        // Neljännen vastaus vaihtoehdot
        add([
          text('Vastaus 1'),
          pos(862, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 2'),
          pos(942, 40),
          scale(0.14),
        ])

        add([
          text('Vastaus 3'),
          pos(1022, 40),
          scale(0.14),
        ])

        // Neljännen kysymys vastaus
        player.onCollide('Vastaus4', (v4) => {
          let x = v4.pos.x;
          let y = v4.pos.y;
          destroyAll('Vastaus4')
          add([pos(x, y), sprite('empty'), area(), solid(), scale(0.4)]);
        })

        player.onCollide('Tunnel', (Tunnel) => {
          go('thirdLevel');
        });

        onUpdate('Spider', (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide('Spider', (Spider) => {
          shake(10);
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown('left', () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown('right', () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress('space', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });

        onKeyPress('up', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      // LEVEL: 3
      scene('thirdLevel', () => {
        debug.log('LEVEL 3');

        add([sprite('bg', { width: width(), height: height() }), pos(0, 0), fixed()]);
        add([sprite('ground', { width: screen.width, height: screen.height }), pos(0, 250), fixed()]);
        // add([sprite('logo', { width: 150, height: 50 }), pos(0, 580), fixed()]);

        let player = add([sprite('mario'), solid(), pos(140, 160), body(), area(), scale(0.7)]);

        gravity(660);

        addLevel(levels[2], {
          width: 20,
          height: 20,
          '=': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '£': () => [sprite('block'), solid(), area(), scale(0.44), ''],
          '+': () => [sprite('tunnel'), solid(), area(), scale(0.5), 'Tunnel'],
          '^': () => [sprite('arrow'), scale(0.4), 'Arrow'],
          '#': () => [sprite('spider'), solid(), area(), scale(1), 'Spider'],
          '%': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus1'],
          '-': () => [sprite('reminder'), area(), scale(0.2), 'Reminder'],
          '¤': () => [sprite('suprise'), solid(), area(), scale(0.4), 'Vastaus2'],
        });

        player.onCollide('Tunnel', (Tunnel) => {
          go('firstLevel');
        });

        player.onCollide('Death', (Death) => {
          shake(50);
          go('thirdLevel');
        });

        onUpdate('Spider', (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide('Spider', (Spider) => {
          shake(10);
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown('left', () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown('right', () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress('space', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });

        onKeyPress('up', () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      onLoad(() => {
        go('firstLevel');
      });
    </script>
  </body>
</html>
