<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <script type="module">
      import kaboom from "https://unpkg.com/kaboom/dist/kaboom.mjs";

      // Config
      kaboom({
        global: true,
        fullscreen: true,
        scale: 2.5,
        debug: true,
        background: [51, 151, 255],
      });

      let playerMoveSpeed = 150;
      let playerJumpForce = 250;
      let playerPoints = 0;

      let scopeA = 0; //Humanistiset ja taidealat
      let scopeB = 0; //Kauppa, hallinto ja oikeustieteet
      let scopeC = 0; //Luonnontieteet
      let scopeD = 0; //Maa- ja metsätalousalat
      let scopeE = 0; //Palvelualat
      let scopeF = 0; //Tekniikan alat
      let scopeG = 0; //Terveys ja hyvinvointialat
      let scopeH = 0; //Tietojenkäsittely ja tietoliikenne

      // Load graphics
      loadSprite("logo", "Kuvat/keuda_logo.png");
      loadSprite("bg", "Kuvat/tausta.png");
      loadSprite("ground", "Kuvat/tausta_alareuna.png");
      loadSprite("mario", "Kuvat/hahmo.png");
      loadSprite("mariojumpoff", "Kuvat/hahmo_aloitus_tippuminen.png");
      loadSprite("suprise", "Kuvat/block_kysymys.png");
      loadSprite("spider", "Kuvat/örkki.png");
      loadSprite("block", "Kuvat/block.png");
      loadSprite("tunnel", "Kuvat/ampari.png");
      loadSprite("arrow", "Kuvat/nuoli.png");
      loadSprite("reminder", "Kuvat/teksti_nuoli.png");
      loadSprite("flagfinish", "Kuvat/maali_tausta_levelille.png");
      loadSprite("start", "Kuvat/start.png");

      // Load sounds
      loadSound("block", "./audio/block.wav");
      loadSound("hit", "./audio/hit.wav");
      loadSound("hyppy", "./audio/jump.mp3");

      // Load levels
      let levels = [
        [
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£                  £",
          "£      (           £",
          "£                  £",
          "£                  £",
          "£                  £",
          "====================",
        ],
        [
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                                                   £",
          "£                         %  %  %             -     £",
          "£                                                   £",
          "£             %  %  %                 %  %  %     ^ £",
          "£                                                   £",
          "£                        =========                + £",
          "£                       ===========                 £",
          "=====================================================",
        ],
        [
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                 =====                                 £",
          "£                    ==      ==            ======                       £",
          "£                                                    ===========        £",
          "£                                                                       £",
          "£                                                                  -    £",
          "£            %  %  %       ==  %  %  %  ==       %  %  %              ^ £",
          "£                                                                       £",
          "£                                                                     + £",
          "£                #                                          #           £",
          "=========================================================================",
        ],
        [
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                                                       £",
          "£                                               #                       £",
          "£                                          ======                       £",
          "£              =======          ==                                   !  £",
          "£                                               #                       £",
          "£                                          ======                       £",
          "£            %  %  %       ==  %  %  %                             -    £",
          "£                                                                     ^ £",
          "£                                                                     + £",
          "£                #                                          #           £",
          "=========================================================================",
        ],
      ];

      scene("firstLevel", () => {
        debug.log("Aloitus ");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(50, 240),
          body(),
          area(),
          scale(0.7),
        ]);

        addLevel(levels[0], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "%": () => [
            sprite("suprise"),
            solid(),
            area(),
            scale(0.4),
            "Suprise",
          ],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],
          "(": () => [sprite("start"), area(), scale(0.5), "Start"],
        });

        player.onCollide("Start", (Start) => {
          go("secondLevel");
        });

        gravity(660);

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.5,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("secondLevel", () => {
        debug.log("TASO 1");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 360),
          body(),
          area(),
          scale(0.7),
        ]);

        addLevel(levels[1], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.5), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "%": () => [
            sprite("suprise"),
            solid(),
            area(),
            scale(0.4),
            "Suprise",
          ],
          "-": () => [sprite("reminder"), area(), scale(0.25), "Reminder"],
        });

        add([text("TASO 1"), pos(125, 350), scale(0.2)]);

        add([text("Kysymys 1"), pos(278, 310), scale(0.2)]);
        add([text("Kylla"), pos(275, 365), scale(0.14)]);
        add([text("Vahan"), pos(335, 365), scale(0.14)]);
        add([text("En"), pos(403, 365), scale(0.14)]);

        add([text("Kysymys 2"), pos(510, 275), scale(0.2)]);
        add([text("Kylla"), pos(516, 325), scale(0.14)]);
        add([text("Vahan"), pos(574, 325), scale(0.14)]);
        add([text("En"), pos(642, 325), scale(0.14)]);

        add([text("Kysymys 3"), pos(760, 310), scale(0.2)]);
        add([text("Kylla"), pos(754, 365), scale(0.14)]);
        add([text("Vahan"), pos(815, 365), scale(0.14)]);
        add([text("En"), pos(882, 365), scale(0.14)]);

        player.onCollide("Tunnel", (Tunnel) => {
          go("thirdLevel");
        });

        gravity(660);

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.5,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("thirdLevel", () => {
        debug.log("TASO 2");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 250),
          body(),
          area(),
          scale(0.7),
        ]);

        gravity(660);

        addLevel(levels[2], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), "Block"],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), "Wall"],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "%": () => [
            sprite("suprise"),
            solid(),
            area(),
            scale(0.4),
            "Suprise",
          ],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],
        });

        add([text("TASO 2"), pos(125, 275), scale(0.2)]);

        add([text("Kysymys 4"), pos(260, 230), scale(0.2)]);
        add([text("Kylla"), pos(255, 286), scale(0.14)]);
        add([text("Vahan"), pos(314, 286), scale(0.14)]);
        add([text("En"), pos(382, 286), scale(0.14)]);

        add([text("Kysymys 5"), pos(620, 230), scale(0.2)]);
        add([text("Kylla"), pos(610, 286), scale(0.14)]);
        add([text("Vahan"), pos(675, 286), scale(0.14)]);
        add([text("En"), pos(740, 286), scale(0.14)]);

        add([text("Kysymys 6"), pos(980, 230), scale(0.2)]);
        add([text("Kylla"), pos(975, 286), scale(0.14)]);
        add([text("Vahan"), pos(1035, 286), scale(0.14)]);
        add([text("En"), pos(1103, 286), scale(0.14)]);

        player.onCollide("Tunnel", (Tunnel) => {
          go("fourthLevel");
        });

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.5,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      scene("fourthLevel", () => {
        debug.log("TASO 3");

        add([
          sprite("bg", { width: width(), height: height() }),
          pos(0, 0),
          fixed(),
        ]);

        add([
          sprite("ground", { width: screen.width, height: screen.height }),
          pos(0, 250),
          fixed(),
        ]);

        let player = add([
          sprite("mario"),
          solid(),
          pos(140, 160),
          body(),
          area(),
          scale(0.7),
        ]);

        gravity(660);

        addLevel(levels[3], {
          width: 20,
          height: 20,
          "=": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "£": () => [sprite("block"), solid(), area(), scale(0.44), ""],
          "+": () => [sprite("tunnel"), solid(), area(), scale(0.5), "Tunnel"],
          "^": () => [sprite("arrow"), scale(0.4), "Arrow"],
          "#": () => [sprite("spider"), solid(), area(), scale(1), "Spider"],
          "*": () => [sprite("arrow"), solid(), area(), scale(0.5), "Death"],
          "%": () => [
            sprite("suprise"),
            solid(),
            area(),
            scale(0.4),
            "Suprise",
          ],
          "-": () => [sprite("reminder"), area(), scale(0.2), "Reminder"],
          "!": () => [
            sprite("flagfinish"),
            solid(),
            area(),
            scale(0.5),
            "flagfinish",
          ],
        });

        add([text("TASO 3"), pos(125, 280), scale(0.2)]);

        add([text("Kysymys 7"), pos(260, 230), scale(0.2)]);
        add([text("Kylla"), pos(255, 286), scale(0.14)]);
        add([text("Vahan"), pos(314, 286), scale(0.14)]);
        add([text("En"), pos(382, 286), scale(0.14)]);

        add([text("Kysymys 8"), pos(620, 230), scale(0.2)]);
        add([text("Kylla"), pos(610, 286), scale(0.14)]);
        add([text("Vahan"), pos(675, 286), scale(0.14)]);
        add([text("En"), pos(740, 286), scale(0.14)]);

        player.onCollide("Tunnel", (Tunnel) => {
          go("firstLevel");
        });

        player.onCollide("Death", (Death) => {
          shake(50);
          go("fourthLevel");
        });

        onUpdate("Spider", (Spider) => {
          Spider.move(-15, 0);
        });

        player.onCollide("Spider", (Spider) => {
          shake(10);
          const hitSound = play("hit", {
            volume: 0.5,
            loop: false,
          });
        });

        player.onUpdate(() => {
          camPos(player.pos);
        });

        onKeyDown("left", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("a", () => {
          player.move(-playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(true);
        });

        onKeyDown("right", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyDown("d", () => {
          player.move(playerMoveSpeed, 0);
          camPos(player.pos);
          player.flipX(false);
        });

        onKeyPress("space", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("up", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
            const jumpSound = play("hyppy", {
              volume: 0.5,
              loop: false,
            });
          }
        });

        onKeyPress("w", () => {
          if (player.isGrounded()) {
            player.jump(playerJumpForce, 0);
          }
        });
      });

      onLoad(() => {
        go("firstLevel");
      });
    </script>
  </body>
</html>
